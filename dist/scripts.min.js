const pokemonRepository = (function () {
  let e = [];
  function t() {
    return e;
  }
  function n(e) {
    let t = document.querySelector(".pokemon-list"),
      n = document.createElement("div");
    n.classList.add("col-4");
    let r = document.createElement("button");
    r.classList.add("btn", "btn-warning"),
      r.setAttribute("data-toggle", "modal"),
      r.setAttribute("data-target", "#exampleModal"),
      (r.innerText = e.name),
      n.appendChild(r),
      t.appendChild(n),
      r.addEventListener("click", function () {
        (function e(t) {
          var n;
          fetch((n = t).detailsUrl)
            .then(function (e) {
              return e.json();
            })
            .then(function (e) {
              (n.imageUrl = e.sprites.front_default),
                (n.height = e.height),
                (n.types = e.types);
            })
            .catch(function (e) {
              console.error(e);
            })
            .then(function () {
              var e;
              let n, r, i, a, l, p, c;
              (e = t),
                (n = $(".modal-body")),
                (r = $(".modal-title")),
                (i = $(".modal-header")),
                r.empty(),
                n.empty(),
                (o.innerHTML = ""),
                console.log("pokemon:", e),
                (a = $("<h5>" + e.name + "</h5>")),
                (l = $('<img class="img" style= width:50%>')),
                l.attr("src", e.imageUrl),
                (p = $("<p>height : " + e.height + "</p>")),
                (c = $(
                  "<p>types : " +
                    e.types?.map((e) => e.type.name).join(",") +
                    "</p>"
                )),
                i.append(a),
                r.append(a),
                n.append(l),
                n.append(p),
                n.append(c);
            });
        })(e);
      });
  }
  document
    .querySelector("#pokemonSearch")
    .addEventListener("input", function (t) {
      if (0 === t.target.value.trim().length)
        (document.querySelector(".pokemon-list").innerHTML = ""),
          e.forEach((e) => {
            n(e);
          });
      else {
        let o = document.querySelector("#pokemonSearch");
        o.value.trim().length > 0 &&
          (function t(o) {
            let r = e.filter((e) => e.name.startsWith(o)),
              i = document.querySelector(".pokemon-list");
            if (((i.innerHTML = ""), 0 === r.length)) {
              i.innerHTML = "No Pokemon was found";
              return;
            }
            r.forEach((e) => {
              n(e);
            });
          })(o.value.trim());
      }
    });
  let o = document.querySelector("#modal-container");
  return {
    getAll: t,
    addListItem: n,
    loadList: function t() {
      return fetch("https://pokeapi.co/api/v2/pokemon/?limit=150")
        .then(function (e) {
          return e.json();
        })
        .then(function (t) {
          t.results.forEach(function (t) {
            var n;
            let o = { name: t.name, detailsUrl: t.url };
            (n = o), e.push(n), console.log(o);
          });
        })
        .catch(function (e) {
          console.error(e);
        });
    },
  };
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
